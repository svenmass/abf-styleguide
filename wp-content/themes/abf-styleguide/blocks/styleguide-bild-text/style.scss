// =============================================================================
// STYLEGUIDE BILD-TEXT BLOCK
// =============================================================================

.block-styleguide-bild-text {
    // Responsive Spacing für alle Styleguide-Blöcke
    @include styleguide-block-spacing-centered;
    width: 100%;
    max-width: $container-content;
    padding: 0;
    
    .styleguide-bild-text-container {
        width: 100%;
        overflow: hidden; // Verhindert Überlauf
        
        // 2-Spalten Grid Layout
        .styleguide-bild-text-grid {
            display: grid;
            gap: $spacing-lg;
            align-items: stretch; // Spalten gleiche Höhe
            width: 100%;
            box-sizing: border-box;
            min-width: 0; // Wichtig für flexibles Grid
            
            @media (max-width: $breakpoint-tablet) {
                // Mobile: Spalten untereinander
                grid-template-columns: 1fr !important;
                gap: $spacing-md;
                
                // Bild immer oben auf Mobile
                .styleguide-bild-text-image-column {
                    order: 1;
                }
                
                .styleguide-bild-text-content-column {
                    order: 2;
                }
            }
        }
        
        // Bild-Spalte
        .styleguide-bild-text-image-column {
            display: flex;
            align-items: stretch;
            justify-content: center;
            width: 100%;
            overflow: hidden;
            min-width: 0; // Wichtig für flexibles Grid
            
            .styleguide-bild-text-image-container {
                width: 100%;
                height: 100%;
                position: relative;
                overflow: hidden;
                // border-radius entfernt (Problem 3)
                
                .styleguide-bild-text-image {
                    width: 100%;
                    height: 100%;
                    object-position: center center;
                    transition: transform 0.3s ease;
                    display: block;
                }
                
                // Cover: Bild füllt Container komplett aus
                &.styleguide-bild-text-image--cover {
                    .styleguide-bild-text-image {
                        object-fit: cover;
                        min-height: 100%;
                    }
                }
                
                // Contain: Bild vollständig sichtbar, oben ausgerichtet
                &.styleguide-bild-text-image--contain {
                    .styleguide-bild-text-image {
                        object-fit: contain;
                        object-position: center top;
                        min-height: 100%;
                    }
                }
                
                @media (max-width: $breakpoint-tablet) {
                    min-height: 250px;
                }
                
                @media (max-width: $breakpoint-mobile) {
                    min-height: 200px;
                }
            }
        }
        
        // Text-Spalte
        .styleguide-bild-text-content-column {
            display: flex;
            align-items: center;
            width: 100%;
            overflow: hidden;
            min-width: 0; // Wichtig für flexibles Grid
            
            .styleguide-bild-text-content {
                width: 100%;
                display: flex;
                flex-direction: column;
                gap: $spacing-sm;
                padding: $spacing-sm 0; // Vertikales Padding für bessere Ausrichtung
                min-width: 0; // Wichtig für flexibles Grid
                
                .styleguide-bild-text-headline {
                    margin: 0;
                    padding: 0;
                    line-height: 1.2; // $line-height-headline nicht verfügbar in diesem Kontext
                    letter-spacing: $letter-spacing-base;
                    font-family: $font-family-primary;
                    word-wrap: break-word;
                    overflow-wrap: break-word;
                    hyphens: auto;
                    -webkit-hyphens: auto;
                    -moz-hyphens: auto;
                    -ms-hyphens: auto;
                    
                    &:has(+ .styleguide-bild-text-text),
                    &:has(+ .styleguide-bild-text-button-wrapper) {
                        margin-bottom: $spacing-sm;
                    }
                }
                
                .styleguide-bild-text-text {
                    margin: 0;
                    padding: 0;
                    line-height: 1.4; // $line-height-base nicht verfügbar in diesem Kontext
                    letter-spacing: $letter-spacing-base;
                    font-family: $font-family-primary;
                    word-wrap: break-word;
                    overflow-wrap: break-word;
                    hyphens: auto;
                    -webkit-hyphens: auto;
                    -moz-hyphens: auto;
                    -ms-hyphens: auto;
                    
                    &:has(+ .styleguide-bild-text-button-wrapper) {
                        margin-bottom: $spacing-sm;
                    }
                    
                    // ✅ WYSIWYG-FREUNDLICHE STYLES: Keine !important, respektiert inline-Styles
                    // Nur Basis-Elemente ohne eigene Formatierung erben
                    > div:not([style*="font-size"]):not([style*="color"]):not([data-abf-color]):not([data-abf-font-size]),
                    > p:not([style*="font-size"]):not([style*="color"]):not([data-abf-color]):not([data-abf-font-size]) {
                        font-size: inherit;
                        font-weight: inherit;
                        color: inherit;
                        line-height: inherit;
                        letter-spacing: inherit;
                    }
                    
                    // Spans erben nur wenn sie keine WYSIWYG-Formatierung haben
                    span:not([style]):not([data-abf-color]):not([data-abf-font-size]) {
                        font-size: inherit;
                        font-weight: inherit;
                        color: inherit;
                    }
                    
                    // Semantische Elemente behalten ihre Funktion
                    strong, b {
                        font-weight: bold; // Nicht überschreiben!
                        font-size: inherit;
                        color: inherit;
                    }
                    
                    em, i {
                        font-style: italic; // Nicht überschreiben!
                        font-size: inherit;
                        color: inherit;
                    }
                    
                    // Links behalten Unterstreichung
                    a {
                        font-size: inherit;
                        font-weight: inherit;
                        color: inherit;
                        text-decoration: underline;
                        
                        &:hover {
                            text-decoration: none;
                        }
                    }
                    
                    // Listen-Styles
                    ul, ol {
                        font-size: inherit;
                        font-weight: inherit;
                        color: inherit;
                        margin: $spacing-sm 0;
                        padding-left: $spacing-md;
                    }
                    
                    li {
                        font-size: inherit;
                        font-weight: inherit;
                        color: inherit;
                        margin-bottom: $spacing-xs;
                    }
                }
                
                .styleguide-bild-text-button-wrapper {
                    margin: 0;
                    padding: 0;
                    
                    .styleguide-bild-text__button {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        font-family: $font-family-primary;
                        font-weight: $font-weight-regular;
                        font-size: $font-size-body;
                        line-height: 1.2;
                        padding: $button-padding-y $button-padding-x;
                        border: none;
                        border-radius: $button-border-radius;
                        text-decoration: none;
                        cursor: pointer;
                        transition: background-color 0.3s ease, color 0.3s ease;
                        white-space: nowrap;
                        
                        &:hover,
                        &:focus {
                            text-decoration: none;
                            outline: none;
                        }
                    }
                }
            }
        }
    }
    
    // Styling für farbigen Container (wenn Hintergrundfarbe gewählt ist)
    .styleguide-bild-text-container.has-background-color {
        border-radius: 10px;
        box-shadow: 0 3px 3px rgba(0, 0, 0, 0.25);
        padding: $spacing-sm;
        
        @media (min-width: $breakpoint-mobile) {
            padding: $spacing-md;
        }
        
        @media (min-width: $breakpoint-tablet) {
            padding: $spacing-md;
        }
        
        @media (min-width: $breakpoint-desktop) {
            padding: $spacing-lg;
        }
    }
}

// =============================================================================
// RESPONSIVE DESIGN
// =============================================================================

// Tablet und kleiner: Vereinfachtes Layout
@media (max-width: $breakpoint-tablet) {
    .block-styleguide-bild-text {
        .styleguide-bild-text-container {
            .styleguide-bild-text-grid {
                gap: $spacing-md;
            }
            
            .styleguide-bild-text-content-column {
                .styleguide-bild-text-content {
                    gap: $spacing-xs;
                    padding: $spacing-xs 0;
                    
                    .styleguide-bild-text-headline:has(+ .styleguide-bild-text-text),
                    .styleguide-bild-text-headline:has(+ .styleguide-bild-text-button-wrapper) {
                        margin-bottom: $spacing-xs;
                    }
                    
                    .styleguide-bild-text-text:has(+ .styleguide-bild-text-button-wrapper) {
                        margin-bottom: $spacing-xs;
                    }
                }
            }
        }
    }
}

// Mobile: Kompaktes Layout
@media (max-width: $breakpoint-mobile) {
    .block-styleguide-bild-text {
        .styleguide-bild-text-container {
            .styleguide-bild-text-grid {
                gap: $spacing-sm;
            }
            
            .styleguide-bild-text-content-column {
                .styleguide-bild-text-content {
                    gap: $spacing-xs;
                    padding: $spacing-xs 0;
                }
            }
        }
    }
}

// Fallback für Browser ohne :has() Support
@supports not (selector(:has(*))) {
    .block-styleguide-bild-text {
        .styleguide-bild-text-content {
            .styleguide-bild-text-headline,
            .styleguide-bild-text-text {
                margin-bottom: $spacing-sm;
                
                @media (max-width: $breakpoint-tablet) {
                    margin-bottom: $spacing-xs;
                }
            }
        }
        
        // =============================================================================
        // DOWNLOADS STYLING
        // =============================================================================
        .styleguide-bild-text-downloads {
            margin-top: $spacing-sm;
            margin-bottom: $spacing-sm;
            
            // Download-Links verwenden das einheitliche Typography-System
            // ABER: Globale Link-Farben überschreiben - deshalb höhere Spezifität nötig!
            a {
                margin-bottom: $spacing-xs;
                
                &:last-child {
                    margin-bottom: 0;
                }
                
                // Erzwinge Typography-System Farben mit höherer Spezifität
                &[href$=".pdf"], &[href$=".PDF"], &[href$=".zip"], &[href$=".ZIP"], 
                &[href$=".jpg"], &[href$=".JPG"], &[href$=".jpeg"], &[href$=".JPEG"], 
                &[href$=".png"], &[href$=".PNG"], &[href$=".svg"], &[href$=".SVG"], 
                &[href$=".xls"], &[href$=".XLS"], &[href$=".xlsx"], &[href$=".XLSX"], 
                &[href$=".dotx"], &[href$=".DOTX"] {
                    // Typography-System Farben (grün → rot) statt globale Link-Farben (rot → grün)
                    color: #74A68E !important;
                    
                    &:hover, &:focus {
                        color: #B62D1F !important;
                    }
                    
                    // Sicherstellen, dass das SVG-Icon angezeigt wird
                    display: inline-flex !important;
                    align-items: center !important;
                    gap: 4px !important;
                    
                    &::before {
                        content: '';
                        display: inline-block !important;
                        width: 24px !important;
                        height: 24px !important;
                        background-image: url("data:image/svg+xml,%3Csvg width='20' height='24' viewBox='0 0 20 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_290_9)'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M2.63781 10.1193C2.14292 9.5872 2.38809 9.08691 3.09184 9.08691H16.6174C17.362 9.08691 17.5663 9.54172 17.1123 10.1193L10.7195 17.8373C10.3836 18.3058 9.73429 18.4104 9.26664 18.0738C9.17584 18.0102 9.09411 17.9283 9.03055 17.8373L2.63781 10.1193Z' fill='%2374A68E'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M18.3927 24.0001H1.5664C0.703746 24.0001 0 23.2997 0 22.4355C0 21.5714 0.699206 20.8665 1.5664 20.8665H18.4336C19.2963 20.8665 20 21.5669 20 22.4355C19.9682 23.3042 19.2599 23.9955 18.3927 24.0046V24.0001Z' fill='%2374A68E'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M7.54596 10.4515V2.43788C7.53688 1.1053 8.60384 0.0137728 9.93869 0.000128653C9.95231 0.000128653 9.96593 0.000128653 9.97955 0.000128653C11.3099 -0.0135155 12.3995 1.05982 12.4132 2.39694C12.4132 2.41059 12.4132 2.42423 12.4132 2.43788V10.4515C12.4268 11.7841 11.3553 12.8756 10.0204 12.8893C10.0068 12.8893 9.99317 12.8893 9.97955 12.8893C8.63563 12.8893 7.5505 11.7977 7.54596 10.4515Z' fill='%2374A68E'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_290_9'%3E%3Crect width='20' height='24' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E") !important;
                        background-size: contain !important;
                        background-repeat: no-repeat !important;
                        background-position: center !important;
                        flex-shrink: 0 !important;
                        transition: all 0.3s ease !important;
                    }
                    
                    &:hover::before, &:focus::before {
                        background-image: url("data:image/svg+xml,%3Csvg width='20' height='24' viewBox='0 0 20 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_290_9)'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M2.63781 10.1193C2.14292 9.5872 2.38809 9.08691 3.09184 9.08691H16.6174C17.362 9.08691 17.5663 9.54172 17.1123 10.1193L10.7195 17.8373C10.3836 18.3058 9.73429 18.4104 9.26664 18.0738C9.17584 18.0102 9.09411 17.9283 9.03055 17.8373L2.63781 10.1193Z' fill='%23B62D1F'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M18.3927 24.0001H1.5664C0.703746 24.0001 0 23.2997 0 22.4355C0 21.5714 0.699206 20.8665 1.5664 20.8665H18.4336C19.2963 20.8665 20 21.5669 20 22.4355C19.9682 23.3042 19.2599 23.9955 18.3927 24.0046V24.0001Z' fill='%23B62D1F'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M7.54596 10.4515V2.43788C7.53688 1.1053 8.60384 0.0137728 9.93869 0.000128653C9.95231 0.000128653 9.96593 0.000128653 9.97955 0.000128653C11.3099 -0.0135155 12.3995 1.05982 12.4132 2.39694C12.4132 2.41059 12.4132 2.42423 12.4132 2.43788V10.4515C12.4268 11.7841 11.3553 12.8756 10.0204 12.8893C10.0068 12.8893 9.99317 12.8893 9.97955 12.8893C8.63563 12.8893 7.5505 11.7977 7.54596 10.4515Z' fill='%23B62D1F'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_290_9'%3E%3Crect width='20' height='24' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E") !important;
                    }
                }
            }
        }
    }
} 